<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|ARM">
      <Configuration>Debug</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM">
      <Configuration>Release</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <Import Project="..\..\..\PCBuild\python.props" />
  <PropertyGroup Label="Globals">
    <ProjectGuid>{98e552fa-8a1c-4916-b63b-ffa88936248c}</ProjectGuid>
    <Keyword>Win32Proj</Keyword>
    <RootNamespace>pyuwpbackgroundservice</RootNamespace>
    <DefaultLanguage>en-US</DefaultLanguage>
    <MinimumVisualStudioVersion>14.0</MinimumVisualStudioVersion>
    <AppContainerApplication>true</AppContainerApplication>
    <ApplicationType>Windows Store</ApplicationType>
    <ApplicationTypeRevision>8.2</ApplicationTypeRevision>
    <UseAppLocalVCLibs>true</UseAppLocalVCLibs>
    <AppxPackage>true</AppxPackage>
    <AppxPackageSigningEnabled>true</AppxPackageSigningEnabled>
    <PackageCertificateKeyFile>pyuwpbackgroundservice_TemporaryKey.pfx</PackageCertificateKeyFile>
    <ContainsStartupTask>true</ContainsStartupTask>
    <WindowsTargetPlatformVersion>10.0.14393.0</WindowsTargetPlatformVersion>
    <WindowsTargetPlatformMinVersion>10.0.14393.0</WindowsTargetPlatformMinVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v140</PlatformToolset>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v140</PlatformToolset>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v140</PlatformToolset>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <PlatformToolset>v140</PlatformToolset>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <PlatformToolset>v140</PlatformToolset>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <PlatformToolset>v140</PlatformToolset>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
    <Import Project="..\..\..\PCBuild\pyproject.props" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
    <Import Project="..\..\..\PCBuild\pyproject.props" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
    <Import Project="..\..\..\PCBuild\pyproject.props" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
    <Import Project="..\..\..\PCBuild\pyproject.props" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
    <Import Project="..\..\..\PCBuild\pyproject.props" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
    <Import Project="..\..\..\PCBuild\pyproject.props" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <GenerateManifest>false</GenerateManifest>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <GenerateManifest>false</GenerateManifest>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <GenerateManifest>false</GenerateManifest>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <GenerateManifest>false</GenerateManifest>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <GenerateManifest>false</GenerateManifest>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <GenerateManifest>false</GenerateManifest>
  </PropertyGroup>
  <PropertyGroup>
    <TargetName>$(ProjectName)</TargetName>
    <OutDir>$(OutDir)$(TargetName)\$(Configuration)\</OutDir>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PreprocessorDefinitions>_WINRT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
      <PrecompiledHeaderOutputFile>$(IntDir)pch.pch</PrecompiledHeaderOutputFile>
      <AdditionalUsingDirectories>$(WindowsSDK_WindowsMetadata);$(AdditionalUsingDirectories)</AdditionalUsingDirectories>
      <AdditionalOptions>/bigobj %(AdditionalOptions)</AdditionalOptions>
      <DisableSpecificWarnings>28204</DisableSpecificWarnings>
      <CompileAsWinRT>true</CompileAsWinRT>
      <AdditionalIncludeDirectories>..\..\..\Python;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <ExceptionHandling>Sync</ExceptionHandling>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <AdditionalDependencies>
      </AdditionalDependencies>
      <AdditionalLibraryDirectories>$(OutDir)..\..;%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <GenerateWindowsMetadata>true</GenerateWindowsMetadata>
      <AdditionalOptions>vccorlibd.lib msvcrtd.lib vcruntimed.lib ucrtd.lib /defaultlib:windowsapp.lib %(AdditionalOptions)</AdditionalOptions>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PreprocessorDefinitions>_WINRT_DLL;NDEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
      <PrecompiledHeaderOutputFile>$(IntDir)pch.pch</PrecompiledHeaderOutputFile>
      <AdditionalUsingDirectories>$(WindowsSDK_WindowsMetadata);$(AdditionalUsingDirectories)</AdditionalUsingDirectories>
      <AdditionalOptions>/bigobj %(AdditionalOptions)</AdditionalOptions>
      <DisableSpecificWarnings>28204</DisableSpecificWarnings>
      <CompileAsWinRT>true</CompileAsWinRT>
      <AdditionalIncludeDirectories>..\..\..\Python;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <ExceptionHandling>Sync</ExceptionHandling>
      <Optimization>Disabled</Optimization>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <AdditionalDependencies>runtimeobject.lib;%(AdditionalDependencies)</AdditionalDependencies>
      <AdditionalLibraryDirectories>$(OutDir)..\..;%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <GenerateWindowsMetadata>true</GenerateWindowsMetadata>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <ClCompile>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PreprocessorDefinitions>_WINRT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
      <PrecompiledHeaderOutputFile>$(IntDir)pch.pch</PrecompiledHeaderOutputFile>
      <AdditionalUsingDirectories>$(WindowsSDK_WindowsMetadata);$(AdditionalUsingDirectories)</AdditionalUsingDirectories>
      <AdditionalOptions>/bigobj %(AdditionalOptions)</AdditionalOptions>
      <DisableSpecificWarnings>28204</DisableSpecificWarnings>
      <CompileAsWinRT>true</CompileAsWinRT>
      <AdditionalIncludeDirectories>..\..\..\Python;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <ExceptionHandling>Sync</ExceptionHandling>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <AdditionalDependencies>
      </AdditionalDependencies>
      <AdditionalLibraryDirectories>$(OutDir)..\..;%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <GenerateWindowsMetadata>true</GenerateWindowsMetadata>
      <AdditionalOptions>vccorlibd.lib msvcrtd.lib vcruntimed.lib ucrtd.lib /defaultlib:windowsapp.lib %(AdditionalOptions)</AdditionalOptions>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <ClCompile>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PreprocessorDefinitions>_WINRT_DLL;NDEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
      <PrecompiledHeaderOutputFile>$(IntDir)pch.pch</PrecompiledHeaderOutputFile>
      <AdditionalUsingDirectories>$(WindowsSDK_WindowsMetadata);$(AdditionalUsingDirectories)</AdditionalUsingDirectories>
      <AdditionalOptions>/bigobj %(AdditionalOptions)</AdditionalOptions>
      <DisableSpecificWarnings>28204</DisableSpecificWarnings>
      <CompileAsWinRT>true</CompileAsWinRT>
      <AdditionalIncludeDirectories>..\..\..\Python;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <ExceptionHandling>Sync</ExceptionHandling>
      <Optimization>Disabled</Optimization>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <AdditionalDependencies>runtimeobject.lib;%(AdditionalDependencies)</AdditionalDependencies>
      <IgnoreAllDefaultLibraries>false</IgnoreAllDefaultLibraries>
      <AdditionalLibraryDirectories>$(OutDir)..\..;%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <GenerateWindowsMetadata>true</GenerateWindowsMetadata>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PreprocessorDefinitions>_WINRT_DLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
      <PrecompiledHeaderOutputFile>$(IntDir)pch.pch</PrecompiledHeaderOutputFile>
      <AdditionalUsingDirectories>$(WindowsSDK_WindowsMetadata);$(AdditionalUsingDirectories)</AdditionalUsingDirectories>
      <AdditionalOptions>/bigobj %(AdditionalOptions)</AdditionalOptions>
      <DisableSpecificWarnings>28204</DisableSpecificWarnings>
      <CompileAsWinRT>true</CompileAsWinRT>
      <AdditionalIncludeDirectories>..\..\..\Python;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <ExceptionHandling>Sync</ExceptionHandling>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <AdditionalDependencies>
      </AdditionalDependencies>
      <IgnoreAllDefaultLibraries>false</IgnoreAllDefaultLibraries>
      <AdditionalLibraryDirectories>$(OutDir)..\..;%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <GenerateWindowsMetadata>true</GenerateWindowsMetadata>
      <AdditionalOptions>vccorlibd.lib msvcrtd.lib vcruntimed.lib ucrtd.lib /defaultlib:windowsapp.lib %(AdditionalOptions)</AdditionalOptions>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PreprocessorDefinitions>_WINRT_DLL;NDEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
      <PrecompiledHeaderOutputFile>$(IntDir)pch.pch</PrecompiledHeaderOutputFile>
      <AdditionalUsingDirectories>$(WindowsSDK_WindowsMetadata);$(AdditionalUsingDirectories)</AdditionalUsingDirectories>
      <AdditionalOptions>/bigobj %(AdditionalOptions)</AdditionalOptions>
      <DisableSpecificWarnings>28204</DisableSpecificWarnings>
      <CompileAsWinRT>true</CompileAsWinRT>
      <AdditionalIncludeDirectories>..\..\..\Python;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <ExceptionHandling>Sync</ExceptionHandling>
      <Optimization>Disabled</Optimization>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <AdditionalDependencies>runtimeobject.lib;%(AdditionalDependencies)</AdditionalDependencies>
      <IgnoreAllDefaultLibraries>false</IgnoreAllDefaultLibraries>
      <AdditionalLibraryDirectories>$(OutDir)..\..;%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <GenerateWindowsMetadata>true</GenerateWindowsMetadata>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <AppxManifest Include="Package.appxmanifest">
      <SubType>Designer</SubType>
    </AppxManifest>
    <None Include="pyuwpbackgroundservice_TemporaryKey.pfx" />
    <None Include="StartupTask.py">
      <DeploymentContent>true</DeploymentContent>
    </None>
    <None Include="ExtensionScraper.py">
      <DeploymentContent>true</DeploymentContent>
    </None>
    <None Include="BuiltinScraper.py">
      <DeploymentContent>true</DeploymentContent>
    </None>
    <None Include="PythonScraper.py">
      <DeploymentContent>true</DeploymentContent>
    </None>
    <None Include="$(OutDir)\lib.zip">
      <DeploymentContent>true</DeploymentContent>
      <Visible>false</Visible>
    </None>
    <Text Include="startupinfo.json">
      <SubType>Designer</SubType>
    </Text>
  </ItemGroup>
  <ItemGroup>
    <Image Include="Assets\Logo.scale-100.png" />
    <Image Include="Assets\SmallLogo.scale-100.png" />
    <Image Include="Assets\StoreLogo.scale-100.png" />
    <Image Include="Assets\SplashScreen.scale-100.png" />
    <Image Include="Assets\WideLogo.scale-100.png" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="pch.h" />
    <ClInclude Include="StartupTask.h" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="pch.cpp">
      <PrecompiledHeader Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">Create</PrecompiledHeader>
      <PrecompiledHeader Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">Create</PrecompiledHeader>
      <PrecompiledHeader Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">Create</PrecompiledHeader>
      <PrecompiledHeader Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">Create</PrecompiledHeader>
      <PrecompiledHeader Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">Create</PrecompiledHeader>
      <PrecompiledHeader Condition="'$(Configuration)|$(Platform)'=='Release|x64'">Create</PrecompiledHeader>
    </ClCompile>
    <ClCompile Include="StartupTask.cpp" />
  </ItemGroup>
  <PropertyGroup>
    <PythonLibRootFolder>..\..\..\Lib</PythonLibRootFolder>
    <WinRTExtensionRootFolder>..\..\..\..\extensions\winrt\WinRTExtension</WinRTExtensionRootFolder>
  </PropertyGroup>
  <ItemGroup>
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\**\__pycache__\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\idlelib\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\lzma\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\mmap\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\msilib\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\multiprocessing\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\sqlite\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\test\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\tkinter\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\venv\**" />
    <ExcludeLibFilters Include="$(PythonLibRootFolder)\webbrowser.py" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\..\PCbuild\uwp\pyexpat.vcxproj">
      <Project>{43ab54bd-cb0d-48d2-81c8-066ee4ded4b9}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCBuild\uwp\pythoncore.vcxproj">
      <Project>{91c36924-3e30-4482-be39-4a780305c187}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCBuild\uwp\select.vcxproj">
      <Project>{a1863edb-6843-4b69-896b-e9183e94751c}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCbuild\uwp\unicodedata.vcxproj">
      <Project>{bbb70146-955e-4282-b2ce-e45d6217fc52}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCbuild\uwp\_bz2.vcxproj">
      <Project>{c63311d8-7796-479a-ab9d-8e681d36dcf3}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCBuild\uwp\_ctypes.vcxproj">
      <Project>{6bccda23-80f4-4c46-a82e-133d64b13fdb}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCbuild\uwp\_ctypes_test.vcxproj">
      <Project>{e557e75d-d541-4141-be50-428c5589a5c4}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCbuild\uwp\_elementtree.vcxproj">
      <Project>{83fa65c4-177f-46d3-afc2-9232a127cc68}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCBuild\uwp\_socket.vcxproj">
      <Project>{b2fbbf74-3e5a-4225-be87-54e54a4f88bc}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCbuild\uwp\_ssl.vcxproj">
      <Project>{5195eec7-59ab-4b59-a53b-83550aea89af}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCbuild\uwp\_testcapi.vcxproj">
      <Project>{dd7be91e-723a-4ef7-9abd-add15ceb19f6}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCbuild\uwp\_testimportmultiple.vcxproj">
      <Project>{6264398b-b2a3-4a30-86f3-82460780e715}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\PCbuild\uwp\_testmultiphase.vcxproj">
      <Project>{24da5a1f-cac2-409b-bca7-aaad7a398b59}</Project>
    </ProjectReference>
    <ProjectReference Include="..\ptvsdhelper\_ptvsdhelper.vcxproj">
      <Project>{18a52e7c-6207-43fc-879b-0dd7952967a2}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\..\extensions\winrt\_winrt\_winrt.vcxproj">
      <Project>{7FD68D21-0C9C-40F0-9CAB-1722FD21C93D}</Project>
    </ProjectReference>
    <ProjectReference Include="..\..\..\..\extensions\winrt\_app_service\_app_service.vcxproj">
      <Project>{1DA495F1-E72D-4901-83D8-6B0BE785C9EF}</Project>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
  <UsingTask TaskName="Zip" TaskFactory="CodeTaskFactory" AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.v4.0.dll">
    <ParameterGroup>
      <InputDirectory ParameterType="System.String" Required="true" />
      <OutputFileName ParameterType="System.String" Required="true" />
      <OverwriteExistingFile ParameterType="System.Boolean" Required="false" />
    </ParameterGroup>
    <Task>
      <Reference Include="System.IO.Compression" />
      <Using Namespace="System.IO.Compression" />
      <Using Namespace="System.IO" />
      <Code Type="Fragment" Language="cs"><![CDATA[        
        const int BufferSize = 64 * 1024;
 
        var buffer = new byte[BufferSize];
        var fileMode = OverwriteExistingFile ? FileMode.Create : FileMode.CreateNew;
        var inputDirectory = new DirectoryInfo(InputDirectory);
        var startIndex = inputDirectory.FullName.Length + 1;
        var lastChangeTime = DateTime.MinValue;
        var lastZipChangeTime = DateTime.MinValue;
        
        if (File.Exists(OutputFileName))
        {
            lastZipChangeTime = new FileInfo(OutputFileName).LastWriteTimeUtc;

            foreach (var inputFile in inputDirectory.EnumerateFiles("*", SearchOption.AllDirectories))
            {
                if (lastChangeTime < inputFile.LastWriteTimeUtc)
                    lastChangeTime = inputFile.LastWriteTimeUtc;
                if (lastZipChangeTime <= lastChangeTime)
                    break;
            }            
        }
        
        if (lastZipChangeTime <= lastChangeTime)
        {
            using (var outputFileStream = new FileStream(OutputFileName, fileMode))
            {
              using (var archive = new ZipArchive(outputFileStream, ZipArchiveMode.Create))
              {
                foreach (var inputFile in inputDirectory.EnumerateFiles("*", SearchOption.AllDirectories))
                {
                  var inputFileName = inputFile.FullName;
                  var archiveEntry = archive.CreateEntry(inputFileName.Substring(startIndex));
     
                  using (var fs = new FileStream(inputFileName, FileMode.Open))
                  {
                    using (var zipStream = archiveEntry.Open())
                    {
                      int bytesRead = -1;
                      while ((bytesRead = fs.Read(buffer, 0, BufferSize)) > 0)
                      {
                        zipStream.Write(buffer, 0, bytesRead);
                      }
                    }
                  }
                }
              }
            }
         }
      ]]></Code>
    </Task>
  </UsingTask>
  <Target Name="CopyLibs">
    <!-- Standard libraries -->
    <ItemGroup>
      <PythonLibFiles Include="$(PythonLibRootFolder)\**" />
      <PythonLibFiles Remove="@(ExcludeLibFilters)" />
    </ItemGroup>
    <MakeDir Directories="$(OutDir)\PythonHome" />
    <Copy SourceFiles="@(PythonLibFiles)" DestinationFolder="$(OutDir)\PythonHome\Lib\%(RecursiveDir)" SkipUnchangedFiles="true" />
    <MakeDir Directories="$(OutDir)\PythonHome\Include" />
    <Copy SourceFiles="..\..\..\PC\pyconfig.h" DestinationFolder="$(OutDir)\PythonHome\Include" SkipUnchangedFiles="true" />
    <!-- WinRT extension -->
    <ItemGroup>
      <WinRTExtensionFiles Include="$(WinRTExtensionRootFolder)\**" />
    </ItemGroup>
    <Copy SourceFiles="@(WinRTExtensionFiles)" DestinationFolder="$(OutDir)\PythonHome\WinRTExtension\%(RecursiveDir)" SkipUnchangedFiles="true" />
    <ItemGroup>
      <None Include="$(OutDir)\PythonHome\**">
        <RootFolder>$(OutDir)</RootFolder>
        <DeploymentContent>true</DeploymentContent>
        <Visible>false</Visible>
      </None>
    </ItemGroup>
  </Target>
  <Target Name="BuildLibs" DependsOnTargets="CopyLibs" BeforeTargets="ClCompile">
    <Zip InputDirectory="$(OutDir)\PythonHome\Lib" OutputFileName="$(OutDir)\lib.zip" OverwriteExistingFile="true" />
    <Zip InputDirectory="$(OutDir)\PythonHome\WinRTExtension" OutputFileName="$(OutDir)\WinRTExtension.zip" OverwriteExistingFile="true" />
  </Target>
</Project>